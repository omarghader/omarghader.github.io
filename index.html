<!doctype html><html lang=en-us><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/omarghader.github.io\/"},"articleSection":"post","headline":"","name":"","description":"Monitoring, DevOps and SmartHome","inLanguage":"en-US","author":{"@type":"Person","name":"Omar Ghader"},"creator":{"@type":"Person","name":"Omar Ghader"},"publisher":{"@type":"Organization","name":"Omar Ghader","logo":{"@type":"ImageObject","url":"https:\/\/omarghader.github.io\/img/logo.png"}},"accountablePerson":{"@type":"Person","name":"Omar Ghader"},"copyrightHolder":{"@type":"Person","name":"Omar Ghader"},"copyrightYear":"0001","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","url":"https:\/\/omarghader.github.io\/","wordCount":"1167","image":"https:\/\/omarghader.github.io\/img/logo.png","keywords":[""]}</script><script>window.addEventListener("load",function(){var b=window._mtm=window._mtm||[],a;b.push({'mtm.startTime':(new Date).getTime(),event:'mtm.Start'}),a=document.createElement('script'),a.async=!0,a.src="https://omarghader.com/matomo/js/container_JgixlzJl.js",document.head.appendChild(a)})</script><title>&#183;</title><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://omarghader.github.io/favicon.ico><link rel=canonical href=https://omarghader.github.io/><meta name=description content="&amp;ldquo;Monitor Home Internet Speed Automatically with Prometheus and Speedtest Exporter&amp;rdquo; date: 2025-08-26 tags: [&amp;ldquo;prometheus&amp;rdquo;, &amp;ldquo;grafana&"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="&amp;ldquo;Monitor Home Internet Speed Automatically with Prometheus and Speedtest Exporter&amp;rdquo; date: 2025-08-26 tags: [&amp;ldquo;prometheus&amp;rdquo;, &amp;ldquo;grafana&"><meta name=twitter:url content="https://omarghader.github.io/"><meta name=twitter:site content="@"><meta property="og:site_name" content><meta property="og:title" content=" &#183; Omar Ghader"><meta property="og:url" content="https://omarghader.github.io/"><meta property="og:type" content="article"><meta property="og:description" content="&amp;ldquo;Monitor Home Internet Speed Automatically with Prometheus and Speedtest Exporter&amp;rdquo; date: 2025-08-26 tags: [&amp;ldquo;prometheus&amp;rdquo;, &amp;ldquo;grafana&"><meta property="article:published_time" content="0001-01-01T00:00:00Z"><meta property="og:image" content="https://omarghader.github.io/img/blog-cover.jpg"><meta name=generator content="Hugo 0.85.0"><link rel=stylesheet type=text/css href=https://omarghader.github.io/built/screen.css><link rel=stylesheet type=text/css href=https://omarghader.github.io/css/casper-two.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css><link rel=stylesheet href=https://omarghader.github.io/css/custom.css></head><body class=post-template><div class=site-wrapper><header class="site-header outer"><div class=inner><nav class=site-nav><div class=site-nav-left><a class=site-nav-logo href=#><img src=https://omarghader.github.io/img/logo.png alt="Omar Ghader"></a><ul class=nav role=menu><li role=menuitem><a href=https://omarghader.github.io/ target>Home</a></li><li role=menuitem><a href=https://omarghader.github.io/about target>About</a></li><li role=menuitem><a href=https://www.linkedin.com/in/marc-ghader/ target=_blank>Contact</a></li><li role=menuitem><a href=https://eepurl.com/h6jxnr target=_blank>Newsletter</a></li></ul></div><div class=site-nav-right><div class=social-links><a class=social-link href=https://github.com/omarghader target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></div></div></nav></div></header><main id=site-main class="site-main outer" role=main><div class=inner><article class="post-full post"><header class=post-full-header><section class=post-full-meta><time class=post-full-meta-date datetime=0001-01-01>1 January 0001</time></section><h1 class=post-full-title></h1></header><figure class=post-full-image style=background-image:url(https://omarghader.github.io/defimg/5.jpg)></figure><section class=post-full-content><div class=kg-card-markdown><h2 id=slug-monitor-home-internet-speed-prometheus-speedtest-exporter>&ldquo;Monitor Home Internet Speed Automatically with Prometheus and Speedtest Exporter&rdquo;
date: 2025-08-26
tags: [&ldquo;prometheus&rdquo;, &ldquo;grafana&rdquo;, &ldquo;speedtest&rdquo;, &ldquo;home automation&rdquo;, &ldquo;monitoring&rdquo;, &ldquo;self-hosted&rdquo;, &ldquo;docker&rdquo;]
description: &ldquo;Step-by-step tutorial to automatically track home internet speed trends and downtime using Prometheus, Speedtest Exporter, and Grafana with visual alerts.&rdquo;
slug: &ldquo;monitor-home-internet-speed-prometheus-speedtest-exporter&rdquo;</h2><div class=intro-box><p>I've been battling my internet service provider for months over sporadic slowdowns that always seem to happen right before my important video calls. Sound familiar? After one too many "everything looks fine on our end" responses, I decided to take matters into my own hands and build a system that automatically tracks my internet speed 24/7.</p><p>In this tutorial, I'll show you how to set up your own internet speed monitoring system using Prometheus and a Speedtest Exporter. You'll be able to track long-term trends, identify patterns, and finally have concrete data to show your ISP when things aren't working as promised.</p></div><h2 id=why-monitor-your-internet-speed>Why Monitor Your Internet Speed?</h2><p>Before we dive into the technical details, let me share why this project has been so valuable for me. Beyond just satisfying my data-obsessed brain, having historical speed data has:</p><ul><li>Provided concrete evidence during ISP support calls</li><li>Helped me identify peak usage times in my neighborhood</li><li>Allowed me to verify I&rsquo;m getting what I&rsquo;m paying for</li><li>Detected outages even when I wasn&rsquo;t home</li></ul><p>The best part? Once set up, this system runs completely automatically in the background, collecting data and sending alerts when things go sideways.</p><h2 id=what-youll-need>What You&rsquo;ll Need</h2><p>Before we start, here&rsquo;s what you&rsquo;ll need to follow along:</p><ul><li>A always-on computer (I&rsquo;m using an Intel NUC running Ubuntu Server)</li><li>Docker and Docker Compose installed</li><li>Basic comfort with command line operations</li><li>About 30-60 minutes of setup time</li></ul><div class=note><p><strong>Note:</strong> While I'm using a dedicated home server, you could run this on a Raspberry Pi, an old laptop, or even in a cloud instance—though running Speedtest from a cloud provider won't give you your home internet speeds, obviously!</p></div><h2 id=step-1-setting-up-the-speedtest-exporter>Step 1: Setting Up the Speedtest Exporter</h2><p>The heart of our monitoring system is the Speedtest Exporter, which automatically runs speed tests and exposes the results in a format that Prometheus can scrape.</p><p>First, let&rsquo;s create a directory structure for our project:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p internet-monitoring/<span style=color:#f92672>{</span>config,data<span style=color:#f92672>}</span>
cd internet-monitoring
</code></pre></div><p>Now, let&rsquo;s create a <code>docker-compose.yml</code> file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.8&#39;</span>

<span style=color:#f92672>services</span>:
  <span style=color:#f92672>speedtest-exporter</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>miguelndecarvalho/speedtest-exporter</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>speedtest-exporter</span>
    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
    <span style=color:#f92672>environment</span>:
      - <span style=color:#ae81ff>MODE=on-demand</span>
      - <span style=color:#ae81ff>INTERVAL=30m</span>
      - <span style=color:#ae81ff>WEB_PORT=9798</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#e6db74>&#34;9798:9798&#34;</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./data/speedtest-exporter:/tmp</span>
</code></pre></div><p>Let me explain what&rsquo;s happening here:</p><ul><li><code>MODE=on-demand</code>: The exporter runs speed tests on a schedule rather than on every scrape</li><li><code>INTERVAL=30m</code>: Runs a speed test every 30 minutes (adjust this based on your needs)</li><li><code>WEB_PORT=9798</code>: The port where metrics will be exposed</li></ul><p>Start the Speedtest Exporter with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose up -d speedtest-exporter
</code></pre></div><p>Verify it&rsquo;s working by visiting <code>http://your-server-ip:9798/metrics</code>. You should see Prometheus metrics after the first test completes (which might take a few minutes).</p><div class=warning><p><strong>Heads up:</strong> The first run might take longer as the Speedtest Exporter needs to establish baseline performance and find optimal servers. Don't panic if you don't see metrics immediately!</p></div><h2 id=step-2-installing-and-configuring-prometheus>Step 2: Installing and Configuring Prometheus</h2><p>Prometheus will be responsible for scraping metrics from our Speedtest Exporter and storing them as time-series data.</p><p>Create a <code>prometheus.yml</code> file in your <code>config</code> directory:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>global</span>:
  <span style=color:#f92672>scrape_interval</span>: <span style=color:#ae81ff>60s</span>
  <span style=color:#f92672>evaluation_interval</span>: <span style=color:#ae81ff>60s</span>

<span style=color:#f92672>scrape_configs</span>:
  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;speedtest-exporter&#39;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#39;speedtest-exporter:9798&#39;</span>]
    <span style=color:#f92672>scrape_interval</span>: <span style=color:#ae81ff>60s</span>
</code></pre></div><p>Now, add Prometheus to your <code>docker-compose.yml</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>services</span>:
  <span style=color:#75715e># Previous speedtest-exporter service here</span>
  
  <span style=color:#f92672>prometheus</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>prom/prometheus</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>prometheus</span>
    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./config/prometheus.yml:/etc/prometheus/prometheus.yml</span>
      - <span style=color:#ae81ff>./data/prometheus:/prometheus</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#e6db74>&#34;9090:9090&#34;</span>
    <span style=color:#f92672>depends_on</span>:
      - <span style=color:#ae81ff>speedtest-exporter</span>
</code></pre></div><p>Update your services with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose up -d
</code></pre></div><p>Check that Prometheus is scraping metrics correctly by visiting <code>http://your-server-ip:9090/targets</code>. You should see the speedtest-exporter target as &ldquo;UP.&rdquo;</p><h2 id=step-3-visualizing-data-with-grafana>Step 3: Visualizing Data with Grafana</h2><p>Now for the fun part—making all that data pretty! Let&rsquo;s add Grafana to our <code>docker-compose.yml</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>services</span>:
  <span style=color:#75715e># Previous services here</span>
  
  <span style=color:#f92672>grafana</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>grafana/grafana-enterprise</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>grafana</span>
    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./data/grafana:/var/lib/grafana</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#e6db74>&#34;3000:3000&#34;</span>
    <span style=color:#f92672>depends_on</span>:
      - <span style=color:#ae81ff>prometheus</span>
</code></pre></div><p>Update your services again:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose up -d
</code></pre></div><p>Now, access Grafana at <code>http://your-server-ip:3000</code> (default login: admin/admin). You&rsquo;ll need to:</p><ol><li>Add Prometheus as a data source (URL: <code>http://prometheus:9090</code>)</li><li>Import a dashboard for visualizing speed test data</li></ol><p>I&rsquo;ve created a dashboard that you can import using ID <code>18691</code> (or find it at <a href=https://grafana.com/grafana/dashboards/>Grafana Labs Dashboards</a>). Alternatively, create your own with these key panels:</p><ul><li>Download/Upload speed over time (using <code>speedtest_download_bits_per_second</code> and <code>speedtest_upload_bits_per_second</code>)</li><li>Latency measurement (using <code>speedtest_ping_latency_milliseconds</code>)</li><li>Current status and last test time</li></ul><div class=pro-tip><p><strong>Pro Tip:</strong> Create a variable for time range shortcuts in your dashboard so you can easily compare "this week vs last week" or "today vs yesterday." This makes identifying patterns much easier!</p></div><h2 id=step-4-setting-up-alerts>Step 4: Setting Up Alerts</h2><p>What good is monitoring without alerts? Let&rsquo;s set up Prometheus alerting to notify us when our internet connection has issues.</p><p>Create an <code>alert.rules.yml</code> file in your <code>config</code> directory:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>groups</span>:
- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>internet-monitoring</span>
  <span style=color:#f92672>rules</span>:
  - <span style=color:#f92672>alert</span>: <span style=color:#ae81ff>InternetDown</span>
    <span style=color:#f92672>expr</span>: <span style=color:#ae81ff>up{job=&#34;speedtest-exporter&#34;} == 0</span>
    <span style=color:#f92672>for</span>: <span style=color:#ae81ff>5m</span>
    <span style=color:#f92672>labels</span>:
      <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>critical</span>
    <span style=color:#f92672>annotations</span>:
      <span style=color:#f92672>summary</span>: <span style=color:#e6db74>&#34;Internet connection is down&#34;</span>
      <span style=color:#f92672>description</span>: <span style=color:#e6db74>&#34;Speedtest exporter has been unreachable for 5 minutes, indicating possible internet outage.&#34;</span>
  
  - <span style=color:#f92672>alert</span>: <span style=color:#ae81ff>DownloadSpeedLow</span>
    <span style=color:#f92672>expr</span>: <span style=color:#ae81ff>speedtest_download_bits_per_second / 1000000 &lt; 50</span>
    <span style=color:#f92672>for</span>: <span style=color:#ae81ff>15m</span>
    <span style=color:#f92672>labels</span>:
      <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>warning</span>
    <span style=color:#f92672>annotations</span>:
      <span style=color:#f92672>summary</span>: <span style=color:#e6db74>&#34;Download speed is consistently low&#34;</span>
      <span style=color:#f92672>description</span>: <span style=color:#e6db74>&#34;Download speed has been below 50 Mbps for 15 minutes. Current value: {{ $value }} Mbps&#34;</span>
  
  - <span style=color:#f92672>alert</span>: <span style=color:#ae81ff>LatencyHigh</span>
    <span style=color:#f92672>expr</span>: <span style=color:#ae81ff>speedtest_ping_latency_milliseconds &gt; 100</span>
    <span style=color:#f92672>for</span>: <span style=color:#ae81ff>10m</span>
    <span style=color:#f92672>labels</span>:
      <span style=color:#f92672>severity</span>: <span style=color:#ae81ff>warning</span>
    <span style=color:#f92672>annotations</span>:
      <span style=color:#f92672>summary</span>: <span style=color:#e6db74>&#34;Network latency is high&#34;</span>
      <span style=color:#f92672>description</span>: <span style=color:#e6db74>&#34;Ping latency has been above 100ms for 10 minutes. Current value: {{ $value }} ms&#34;</span>
</code></pre></div><p>Update your <code>prometheus.yml</code> to include the alerting rules:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># Add to your existing prometheus.yml</span>
<span style=color:#f92672>rule_files</span>:
  - <span style=color:#e6db74>&#39;/etc/prometheus/alert.rules.yml&#39;</span>

<span style=color:#f92672>alerting</span>:
  <span style=color:#f92672>alertmanagers</span>:
    - <span style=color:#f92672>static_configs</span>:
        - <span style=color:#f92672>targets</span>:
          <span style=color:#75715e># We&#39;ll set up Alertmanager in the next step</span>
</code></pre></div><p>For alert notifications, let&rsquo;s add Alertmanager to our <code>docker-compose.yml</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>services</span>:
  <span style=color:#75715e># Previous services here</span>
  
  <span style=color:#f92672>alertmanager</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>prom/alertmanager</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>alertmanager</span>
    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./config/alertmanager.yml:/etc/alertmanager/alertmanager.yml</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#e6db74>&#34;9093:9093&#34;</span>
</code></pre></div><p>Create an <code>alertmanager.yml</code> configuration for email alerts (or other notification channels):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>route</span>:
  <span style=color:#f92672>group_by</span>: [<span style=color:#e6db74>&#39;alertname&#39;</span>]
  <span style=color:#f92672>group_wait</span>: <span style=color:#ae81ff>30s</span>
  <span style=color:#f92672>group_interval</span>: <span style=color:#ae81ff>5m</span>
  <span style=color:#f92672>repeat_interval</span>: <span style=color:#ae81ff>3h</span>
  <span style=color:#f92672>receiver</span>: <span style=color:#e6db74>&#39;email-notifications&#39;</span>

<span style=color:#f92672>receivers</span>:
- <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;email-notifications&#39;</span>
  <span style=color:#f92672>email_configs</span>:
  - <span style=color:#f92672>to</span>: <span style=color:#e6db74>&#39;your-email@example.com&#39;</span>
    <span style=color:#f92672>from</span>: <span style=color:#e6db74>&#39;alertmanager@your-domain.com&#39;</span>
    <span style=color:#f92672>smarthost</span>: <span style=color:#e6db74>&#39;smtp.gmail.com:587&#39;</span>
    <span style=color:#f92672>auth_username</span>: <span style=color:#e6db74>&#39;your-email@gmail.com&#39;</span>
    <span style=color:#f92672>auth_password</span>: <span style=color:#e6db74>&#39;your-app-password&#39;</span>
    <span style=color:#f92672>send_resolved</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>Finally, update your Prometheus configuration to point to Alertmanager:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>alerting</span>:
  <span style=color:#f92672>alertmanagers</span>:
    - <span style=color:#f92672>static_configs</span>:
        - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#39;alertmanager:9093&#39;</span>]
</code></pre></div><p>Restart all services:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker-compose up -d
</code></pre></div><div class=note><p><strong>Note:</strong> For Gmail, you'll need to generate an App Password rather than using your regular password. Also consider setting up additional notification channels like Slack or Telegram for important alerts!</p></div><h2 id=step-5-optimizing-and-fine-tuning>Step 5: Optimizing and Fine-Tuning</h2><p>Now that everything is running, let&rsquo;s optimize our setup:</p><p><strong>Adjust test frequency based on your needs:</strong></p><ul><li>More frequent tests (15m) = more data but higher data usage</li><li>Less frequent tests (60m) = less granularity but lower impact</li></ul><p><strong>Reduce storage requirements</strong> by adding retention settings to Prometheus:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># In your prometheus.yml under global:</span>
<span style=color:#f92672>global</span>:
  <span style=color:#f92672>scrape_interval</span>: <span style=color:#ae81ff>60s</span>
  <span style=color:#f92672>evaluation_interval</span>: <span style=color:#ae81ff>60s</span>
  <span style=color:#f92672>retention</span>: <span style=color:#ae81ff>30d </span> <span style=color:#75715e># Keep data for 30 days</span>
</code></pre></div><p><strong>Add resource limits</strong> to your Docker Compose to prevent excessive resource usage:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>services</span>:
  <span style=color:#f92672>speedtest-exporter</span>:
    <span style=color:#75715e># ... existing config</span>
    <span style=color:#f92672>deploy</span>:
      <span style=color:#f92672>resources</span>:
        <span style=color:#f92672>limits</span>:
          <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>256M</span>
</code></pre></div><h2 id=troubleshooting-common-issues>Troubleshooting Common Issues</h2><p>Here are some problems I encountered and how to fix them:</p><p><strong>Speedtest fails with &ldquo;No servers defined&rdquo; error:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Check logs</span>
docker logs speedtest-exporter

<span style=color:#75715e># Sometimes restarting helps</span>
docker restart speedtest-exporter</code></pre></div></div><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=auto data-full-width-responsive=true data-ad-client=ca-pub-2980078129213070 data-ad-slot></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></section><footer class=post-full-footer><section class=author-card><img class=author-profile-image src=https://omarghader.github.io/img/me/omar.jpg alt=Author><section class=author-card-content><h4 class=author-card-name><a href=https://omarghader.github.io/>Omar Ghader</a></h4><p>Monitoring, DevOps and SmartHome</p></section></section></footer></article></div></main><aside class="read-next outer"><div class=inner><div class=read-next-feed><article class=read-next-card style=background-image:url(https://omarghader.github.io/img/blog-cover.jpg)><header class=read-next-card-header><small class=read-next-card-header-sitetitle>&mdash; Omar Ghader &mdash;</small></header><div class=read-next-divider><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg></div><div class=read-next-card-content><ul><li><a href=https://omarghader.github.io/esp32-smart-thermostat-home-assistant-relay-sensors/>Build a Smart Thermostat with ESP32, Home Assistant, and Relays</a></li><li><a href=https://omarghader.github.io/monitoring-stack-prometheus-victoriametrics-grafana/>Building a Monitoring Stack with Prometheus, VictoriaMetrics, and Grafana: A Full Setup Guide</a></li><li><a href=https://omarghader.github.io/esp32-airquality-box-wp6003-homeassistant/>Cheap 15$ Air quality monitor: ESP32, Bluetooth & Home assistant</a></li><li><a href=https://omarghader.github.io/docker-compose-nginx-tutorial/>Docker Compose Nginx Tutorial</a></li></ul></div><footer class=read-next-card-footer></footer></article><article class="post-card post"><a class=post-card-image-link href=https://omarghader.github.io/my-first-post/><div class=post-card-image style=background-image:url(https://omarghader.github.io/defimg/5.jpg)></div></a><div class=post-card-content><a class=post-card-content-link href=https://omarghader.github.io/my-first-post/><header class=post-card-header><span class=post-card-tags>#Android
#Java
#Android development
#DevOps
#Ansible
#provisionning
#vagrant</span><h2 class=post-card-title>My First Post</h2></header><section class=post-card-excerpt><p>This post will resume the subjects of my next posts</p></section></a><footer class=post-card-meta><img class=author-profile-image src=https://omarghader.github.io/img/me/omar.jpg alt=Author>
<span class=post-card-author><a href=https://omarghader.github.io/>Omar Ghader</a></span></footer></div></article></div></div></aside><div class=floating-header><div class=floating-header-logo><a href=https://omarghader.github.io/><img src=https://omarghader.github.io/img/logo.png alt>
<span></span></a></div><span class=floating-header-divider>&mdash;</span><div class=floating-header-title></div><div class=floating-header-share><div class=floating-header-share-label>Share this<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 15.5V4a1.5 1.5.0 113 0v4.5h2a1 1 0 011 1h2a1 1 0 011 1H18a1.5 1.5.0 011.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2.0 011.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg></div><a class=floating-header-share-tw href="https://twitter.com/share?text=&url=https%3a%2f%2fomarghader.github.io%2f" onclick="return window.open(this.href,'share-twitter','width=550,height=235'),!1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088.0 01-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015.0 01-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25.0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688.0 5.063-.875 7.188-2.5-1.25.0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5.0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673.0 01-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228.0 01-1.875-2c-.5-.875-.688-1.813-.688-2.75.0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579.0 011.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48.0 003.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a><a class=floating-header-share-fb href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fomarghader.github.io%2f" onclick="return window.open(this.href,'share-facebook','width=580,height=296'),!1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86.0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg></a></div><progress class=progress value=0><div class=progress-container><span class=progress-bar></span></div></progress></div><footer class="site-footer outer"><div class="site-footer-content inner"><section class=copyright style=line-height:1.3em><a href=https://omarghader.github.io/>omarghader</a><br></section><nav class=site-footer-nav><a href=https://omarghader.github.io/>Latest Posts</a>
<a href=https://github.com/omarghader target=_blank rel=noopener>Github</a></nav></div></footer></div><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script type=text/javascript src=//code.jquery.com/jquery-3.2.1.min.js></script><script type=text/javascript src=https://omarghader.github.io/js/jquery.fitvids.js></script><script>hljs.initHighlightingOnLoad()</script><script>window.addEventListener("load",function(){var a=document.createElement("script");a.src="https://www.googletagmanager.com/gtag/js?id=G-SMB08YT14H",a.async=!0,document.head.appendChild(a),a.onload=function(){window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date),a("config","G-SMB08YT14H")}})</script><script>$(document).ready(function(){var j=$(".post-full-content"),g,d,e,b,f,c,a;j.fitVids(),g=document.querySelector('progress'),d=document.querySelector('.floating-header'),e=document.querySelector('.post-full-title'),b=window.scrollY,f=window.innerHeight,c=$(document).height(),a=!1;function k(){b=window.scrollY,h()}function l(){f=window.innerHeight,c=$(document).height(),h()}function h(){a||requestAnimationFrame(i),a=!0}function i(){var h=e.getBoundingClientRect().top+window.scrollY,i=e.offsetHeight+35,j=c-f;b>=h+i?d.classList.add('floating-active'):d.classList.remove('floating-active'),g.setAttribute('max',j),g.setAttribute('value',b),a=!1}window.addEventListener('scroll',k,{passive:!0}),window.addEventListener('resize',l,!1),i()})</script></body></html>