<!doctype html><html lang=en-us><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/omarghader.github.io\/automate-air-purifier-esp32-home-assistant-aqi\/"},"articleSection":"post","headline":"Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index","name":"Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index","description":"Learn how to read the Home Assistant Air Quality Index and automatically control an air purifier using an ESP32 relay for a smarter, healthier home.","inLanguage":"en-US","author":{"@type":"Person","name":"Omar Ghader"},"creator":{"@type":"Person","name":"Omar Ghader"},"publisher":{"@type":"Organization","name":"Omar Ghader","logo":{"@type":"ImageObject","url":"https:\/\/omarghader.github.io\/img/logo.png"}},"accountablePerson":{"@type":"Person","name":"Omar Ghader"},"copyrightHolder":{"@type":"Person","name":"Omar Ghader"},"copyrightYear":"2025","datePublished":"2025-10-21T00:00:00Z","dateModified":"2025-10-21T00:00:00Z","url":"https:\/\/omarghader.github.io\/automate-air-purifier-esp32-home-assistant-aqi\/","wordCount":"1838","image":"https:\/\/omarghader.github.io\/img/logo.png","keywords":["home assistant","esp32","air quality","automation","esphome","aqi","smart home",""]}</script><script>window.addEventListener("load",function(){var b=window._mtm=window._mtm||[],a;b.push({'mtm.startTime':(new Date).getTime(),event:'mtm.Start'}),a=document.createElement('script'),a.async=!0,a.src="https://omarghader.com/matomo/js/container_JgixlzJl.js",document.head.appendChild(a)})</script><title>Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index &#183;</title><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://omarghader.github.io/favicon.ico><link rel=canonical href=https://omarghader.github.io/automate-air-purifier-esp32-home-assistant-aqi/><meta name=description content="Learn how to read the Home Assistant Air Quality Index and automatically control an air purifier using an ESP32 relay for a smarter, healthier home."><meta name=twitter:card content="summary"><meta name=twitter:title content="Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index"><meta name=twitter:description content="Learn how to read the Home Assistant Air Quality Index and automatically control an air purifier using an ESP32 relay for a smarter, healthier home."><meta name=twitter:url content="https://omarghader.github.io/automate-air-purifier-esp32-home-assistant-aqi/"><meta name=twitter:site content="@"><meta property="og:site_name" content><meta property="og:title" content="Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index &#183; Omar Ghader"><meta property="og:url" content="https://omarghader.github.io/automate-air-purifier-esp32-home-assistant-aqi/"><meta property="og:type" content="article"><meta property="og:description" content="Learn how to read the Home Assistant Air Quality Index and automatically control an air purifier using an ESP32 relay for a smarter, healthier home."><meta property="article:published_time" content="2025-10-21T00:00:00Z"><meta property="article:tag" content="home assistant"><meta property="article:tag" content="esp32"><meta property="article:tag" content="air quality"><meta property="article:tag" content="automation"><meta property="article:tag" content="esphome"><meta property="article:tag" content="aqi"><meta property="article:tag" content="smart home"><meta property="og:image" content="https://omarghader.github.io/img/blog-cover.jpg"><meta name=generator content="Hugo 0.85.0"><link rel=stylesheet type=text/css href=https://omarghader.github.io/built/screen.css><link rel=stylesheet type=text/css href=https://omarghader.github.io/css/casper-two.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css><link rel=stylesheet href=https://omarghader.github.io/css/custom.css></head><body class=post-template><div class=site-wrapper><header class="site-header outer"><div class=inner><nav class=site-nav><div class=site-nav-left><a class=site-nav-logo href=#><img src=https://omarghader.github.io/img/logo.png alt="Omar Ghader"></a><ul class=nav role=menu><li role=menuitem><a href=https://omarghader.github.io/ target>Home</a></li><li role=menuitem><a href=https://omarghader.github.io/about target>About</a></li><li role=menuitem><a href=https://www.linkedin.com/in/marc-ghader/ target=_blank>Contact</a></li><li role=menuitem><a href=https://eepurl.com/h6jxnr target=_blank>Newsletter</a></li></ul></div><div class=site-nav-right><div class=social-links><a class=social-link href=https://github.com/omarghader target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></div></div></nav></div></header><main id=site-main class="site-main outer" role=main><div class=inner><article class="post-full post"><header class=post-full-header><section class=post-full-meta><time class=post-full-meta-date datetime=2025-10-21>21 October 2025</time>
<span class=date-divider>/</span> <a href=https://omarghader.github.io/tags/home-assistant/>#home assistant</a>&nbsp;<a href=https://omarghader.github.io/tags/esp32/>#esp32</a>&nbsp;</section><h1 class=post-full-title>Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index</h1></header><figure class=post-full-image style=background-image:url(https://omarghader.github.io/defimg/3.jpg)></figure><section class=post-full-content><div class=kg-card-markdown><p>I’ve always been a bit obsessive about air quality. Living in a city, you notice the difference a good air purifier makes, but I got tired of manually turning it on every time the pollution levels spiked. It felt, well, decidedly <em>un-smart</em>. So I set out to fix that by creating a system where my air purifier automatically kicks in when the Home Assistant Air Quality Index (AQI) reaches a certain threshold.</p><p>The result? A perfectly automated, healthier living space that requires zero intervention. In this step-by-step guide, I’ll show you how to <strong>control and automate an air purifier with ESP32 and Home Assistant Air Quality Index</strong> monitoring. We&rsquo;ll use a simple relay to safely interface with the purifier and ESPhome to make the ESP32 a seamless part of our smart home.</p><h2 id=what-youll-need>What You&rsquo;ll Need</h2><p>Before we dive in, let&rsquo;s gather our tools. Here&rsquo;s the shopping list for this project:</p><ul><li><strong>ESP32 Development Board</strong>: The brains of the operation. I used a generic ESP32 DevKit, which is cheap and powerful.</li><li><strong>5V Relay Module</strong>: This is the switch that will safely control your air purifier. <a href=https://amzn.to/3V9aHvT>A 1-channel relay like this one is perfect.</a></li><li><strong>Jumper Wires (Male-to-Female)</strong>: For making connections without a breadboard.</li><li><strong>Micro-USB Cable</strong>: To power the ESP32.</li><li><strong>AC Power Cord & Socket (Optional but Recommended)</strong>: For a safe and permanent installation. You can get an <a href=https://amzn.to/4fLz7iH>outlet box kit</a> to house the relay cleanly.</li><li><strong>A Smart Air Quality Sensor</strong>: I&rsquo;m assuming you already have an AQI sensor in Home Assistant. This could be a PurpleAir, a DIY sensor with an SDS011, or even a weather service providing local AQI data.</li><li><strong>Home Assistant Instance</strong>: Obviously, you&rsquo;ll need Home Assistant set up and running.</li><li><strong>ESPhome Add-on</strong>: Installed in your Home Assistant instance.</li></ul><h2 id=step-1-the-hardware-hookup-its-easier-than-you-think>Step 1: The Hardware Hookup (It&rsquo;s Easier Than You Think)</h2><p>Don&rsquo;t let the wires intimidate you; this is a simple circuit. We&rsquo;re connecting the relay to the ESP32 so that Home Assistant can tell the ESP32 to flip the switch.</p><p>Here’s the wiring diagram in text form:</p><ol><li><strong>Relay VCC</strong> → ESP32 <strong>5V</strong> pin</li><li><strong>Relay GND</strong> → ESP32 <strong>GND</strong> pin</li><li><strong>Relay IN</strong> (or SIG) → ESP32 <strong>GPIO 23</strong> (You can use almost any GPIO pin, I just like 23)</li></ol><div style="background-color:#f0f8ff;padding:15px;border-left:5px solid #3498db;margin:20px 0"><strong>⚠️ Safety First!</strong> If you're planning to control a high-voltage device like a plug-in air purifier, please, please be careful. Use a pre-made outlet box or ensure all high-voltage connections are properly insulated and enclosed. We're only dealing with low-voltage (5V) on the ESP32 side.</div><p>The relay acts as a switch for the air purifier&rsquo;s power. The ESP32 sends a 3.3V signal to the relay&rsquo;s input pin, which activates an electromagnet inside, physically flipping the switch on the high-voltage side. It&rsquo;s a simple, isolated, and safe way to control AC devices.</p><h2 id=step-2-flashing-the-esp32-with-esphome>Step 2: Flashing the ESP32 with ESPhome</h2><p>ESPhome is the magic glue that makes DIY ESP devices feel native in Home Assistant. We&rsquo;ll create a configuration file to define our relay switch.</p><ol><li>In your Home Assistant sidebar, go to <strong>Settings</strong> -> <strong>Add-ons</strong>.</li><li>If you haven&rsquo;t already, install the <strong>ESPhome</strong> add-on.</li><li>Open the ESPhome dashboard and click <strong>+ NEW DEVICE</strong>. Follow the prompts to set up a new device, giving it a name like <code>air-purifier-controller</code>. When asked for a platform, select <strong>ESP32</strong>.</li></ol><p>Now, let&rsquo;s craft the configuration. Replace the default YAML code with the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># air-purifier-controller.yaml</span>
<span style=color:#f92672>esphome</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>air-purifier-controller</span>
  <span style=color:#f92672>friendly_name</span>: <span style=color:#ae81ff>Air Purifier Controller</span>

<span style=color:#f92672>esp32</span>:
  <span style=color:#f92672>board</span>: <span style=color:#ae81ff>esp32dev</span>
  <span style=color:#f92672>framework</span>:
    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>arduino</span>

<span style=color:#75715e># Enable logging and a simple API for Home Assistant communication</span>
<span style=color:#f92672>logger</span>:
<span style=color:#f92672>api</span>:
<span style=color:#f92672>ota</span>:
  <span style=color:#f92672>password</span>: <span style=color:#e6db74>&#34;your_secure_ota_password&#34;</span>

<span style=color:#f92672>wifi</span>:
  <span style=color:#f92672>ssid</span>: !<span style=color:#ae81ff>secret wifi_ssid</span>
  <span style=color:#f92672>password</span>: !<span style=color:#ae81ff>secret wifi_password</span>

  <span style=color:#75715e># Optional: Add a fallback hotspot in case WiFi fails</span>
  <span style=color:#f92672>ap</span>:
    <span style=color:#f92672>ssid</span>: <span style=color:#e6db74>&#34;Air-Purifier-Controller Fallback&#34;</span>
    <span style=color:#f92672>password</span>: <span style=color:#e6db74>&#34;another_secure_password&#34;</span>

<span style=color:#f92672>captive_portal</span>:

<span style=color:#75715e># Our main component - the relay switch</span>
<span style=color:#f92672>switch</span>:
  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>gpio</span>
    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Air Purifier Relay&#34;</span>
    <span style=color:#f92672>pin</span>: <span style=color:#ae81ff>GPIO23</span>
    <span style=color:#f92672>id</span>: <span style=color:#ae81ff>relay_purifier</span>
    <span style=color:#f92672>icon</span>: <span style=color:#e6db74>&#34;mdi:air-purifier&#34;</span>
    <span style=color:#75715e># Assuming your relay is &#39;active low&#39;. If it behaves backwards, set this to &#39;true&#39;.</span>
    <span style=color:#f92672>inverted</span>: <span style=color:#66d9ef>false</span>
</code></pre></div><p>A few things to note here:</p><ul><li><strong>Secrets</strong>: I&rsquo;m using <code>!secret</code> for my WiFi credentials. You should too! Create a <code>secrets.yaml</code> file in your ESPhome folder and define <code>wifi_ssid</code> and <code>wifi_password</code> there.</li><li><strong>OTA</strong>: The <code>ota</code> section allows you to push future updates to the ESP32 over-the-air, which is incredibly convenient.</li><li><code>inverted: false</code>: Some relay modules are &ldquo;active low,&rdquo; meaning they turn on when the signal is LOW. If your relay clicks &ldquo;on&rdquo; when you flash the firmware but is &ldquo;off&rdquo; in Home Assistant, change this to <code>inverted: true</code>.</li></ul><p>Save the configuration and click <strong>INSTALL</strong>. Choose the <strong>Plug into this computer</strong> method and follow the on-screen instructions to flash your ESP32. Once it&rsquo;s done, the device should connect to your WiFi and appear in your Home Assistant dashboard.</p><h2 id=step-3-integrating-the-aqi-sensor-in-home-assistant>Step 3: Integrating the AQI Sensor in Home Assistant</h2><p>For the automation to work, Home Assistant needs a reliable air quality sensor. I use a <a href=https://www.home-assistant.io/integrations/purpleair/>PurpleAir sensor integration</a>, but the process is similar for any sensor.</p><p>Your sensor entity will likely have an attribute for the AQI. You can find this by going to <strong>Settings</strong> -> <strong>Devices & Services</strong> -> <strong>Entities</strong> and searching for your sensor. Look for an attribute like <code>aqi</code> or <code>air_quality_index</code>.</p><p>To make this easier to use in an automation, let&rsquo;s create a template sensor that exposes the AQI as its own state.</p><p>Add this to your <code>configuration.yaml</code> file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># In configuration.yaml</span>
<span style=color:#f92672>template</span>:
  - <span style=color:#f92672>sensor</span>:
      - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Living Room AQI&#34;</span>
        <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#34;AQI&#34;</span>
        <span style=color:#75715e># Replace &#39;sensor.purpleair_sensor&#39; with your actual sensor entity_id</span>
        <span style=color:#f92672>state</span>: <span style=color:#e6db74>&#34;{{ state_attr(&#39;sensor.purpleair_sensor&#39;, &#39;aqi&#39;) | int }}&#34;</span>
        <span style=color:#75715e># If your sensor provides PM2.5, you can calculate AQI directly.</span>
        <span style=color:#75715e># Uncomment and use the lines below instead, replacing with your PM2.5 entity.</span>
        <span style=color:#75715e># state: &gt;</span>
        <span style=color:#75715e>#   {% set pm25 = states(&#39;sensor.living_room_pm25&#39;) | float %}</span>
        <span style=color:#75715e>#   {{ ((pm25 / 12.0) * 100) | round(0) }}</span>
</code></pre></div><p>Restart Home Assistant. You should now have a new sensor called <code>sensor.living_room_aqi</code> that gives a clean numeric AQI value.</p><h2 id=step-4-creating-the-magic---the-home-assistant-automation>Step 4: Creating the Magic - The Home Assistant Automation</h2><p>This is where it all comes together. We&rsquo;ll create an automation that watches the AQI sensor and toggles our ESP32 relay.</p><p>Go to <strong>Settings</strong> -> <strong>Automations & Scenes</strong> -> <strong>Create Automation</strong>.</p><p>Choose &ldquo;Create new automation&rdquo; and switch to the <strong>YAML</strong> tab. Paste the following configuration:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>alias</span>: <span style=color:#e6db74>&#34;Auto-Control Air Purifier based on AQI&#34;</span>
<span style=color:#f92672>description</span>: <span style=color:#e6db74>&#34;Turn on the air purifier when AQI is poor, turn it off when it&#39;s good again.&#34;</span>
<span style=color:#f92672>trigger</span>:
  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>numeric_state</span>
    <span style=color:#f92672>entity_id</span>: <span style=color:#ae81ff>sensor.living_room_aqi</span>
    <span style=color:#f92672>above</span>: <span style=color:#ae81ff>50</span>
    <span style=color:#f92672>for</span>:
      <span style=color:#f92672>minutes</span>: <span style=color:#ae81ff>5</span>
  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>numeric_state</span>
    <span style=color:#f92672>entity_id</span>: <span style=color:#ae81ff>sensor.living_room_aqi</span>
    <span style=color:#f92672>below</span>: <span style=color:#ae81ff>35</span>
    <span style=color:#f92672>for</span>:
      <span style=color:#f92672>minutes</span>: <span style=color:#ae81ff>10</span>
<span style=color:#f92672>condition</span>: []
<span style=color:#f92672>action</span>:
  - <span style=color:#f92672>choose</span>:
      - <span style=color:#f92672>conditions</span>:
          - <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>template</span>
            <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ trigger.to_state.state | int &gt; 50 }}&#34;</span>
        <span style=color:#f92672>sequence</span>:
          - <span style=color:#f92672>service</span>: <span style=color:#ae81ff>switch.turn_on</span>
            <span style=color:#f92672>target</span>:
              <span style=color:#f92672>entity_id</span>: <span style=color:#ae81ff>switch.air_purifier_relay</span>
            <span style=color:#f92672>data</span>: {}
          - <span style=color:#f92672>service</span>: <span style=color:#ae81ff>notify.mobile_app_your_phone</span>
            <span style=color:#f92672>data</span>:
              <span style=color:#f92672>message</span>: <span style=color:#e6db74>&#34;Air quality is poor (AQI {{ trigger.to_state.state }}). Air purifier turned on.&#34;</span>
      - <span style=color:#f92672>conditions</span>:
          - <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>template</span>
            <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ trigger.to_state.state | int &lt; 35 }}&#34;</span>
        <span style=color:#f92672>sequence</span>:
          - <span style=color:#f92672>service</span>: <span style=color:#ae81ff>switch.turn_off</span>
            <span style=color:#f92672>target</span>:
              <span style=color:#f92672>entity_id</span>: <span style=color:#ae81ff>switch.air_purifier_relay</span>
            <span style=color:#f92672>data</span>: {}
          - <span style=color:#f92672>service</span>: <span style=color:#ae81ff>notify.mobile_app_your_phone</span>
            <span style=color:#f92672>data</span>:
              <span style=color:#f92672>message</span>: <span style=color:#e6db74>&#34;Air quality is back to good (AQI {{ trigger.to_state.state }}). Air purifier turned off.&#34;</span>
    <span style=color:#f92672>default</span>: []
<span style=color:#f92672>mode</span>: <span style=color:#ae81ff>single</span>
</code></pre></div><p>Let&rsquo;s break down this automation:</p><ul><li><strong>Triggers</strong>: We have two.<ol><li>Trigger when AQI goes <strong>above 50</strong> for 5 minutes. (This turns the purifier ON).</li><li>Trigger when AQI goes <strong>below 35</strong> for 10 minutes. (This turns the purifier OFF). I use a longer delay here to prevent short-cycling the purifier.</li></ol></li><li><strong>Actions</strong>: The <code>choose</code> block decides what to do based on which trigger fired.<ul><li>If the AQI is high, it turns on the relay and sends a notification.</li><li>If the AQI is low, it turns off the relay and sends another notification.</li></ul></li></ul><div style="background-color:#f0f0f0;padding:15px;border-radius:5px;margin:20px 0"><strong>💡 Pro Tip: Hysteresis is Your Friend</strong><br>Notice I use two different thresholds (50 to turn on, 35 to turn off). This is called hysteresis. It prevents the automation from rapidly turning the purifier on and off if the AQI is hovering right around a single value. Tweak these numbers based on your comfort level and your purifier's effectiveness.</div><p>Save the automation, and you&rsquo;re in business!</p><h2 id=troubleshooting-and-common-pitfalls>Troubleshooting and Common Pitfalls</h2><p>No project is complete without a few hiccups. Here are some I ran into:</p><ul><li><strong>The relay clicks but the purifier doesn&rsquo;t turn on.</strong> Double-check your high-voltage wiring if you&rsquo;re using a custom cord. If you&rsquo;re plugging the purifier into the relay module, ensure the module is rated for the purifier&rsquo;s current (amps).</li><li><strong>The ESP32 won&rsquo;t connect to WiFi.</strong> Check your <code>secrets.yaml</code> file. The ESPhome logs (click &ldquo;LOGS&rdquo; on the device in the dashboard) are your best friend here.</li><li><strong>The automation doesn&rsquo;t trigger.</strong> Go to <strong>Developer Tools</strong> -> <strong>States</strong> and check if your <code>sensor.living_room_aqi</code> has a valid numeric state. Also, check the &ldquo;Traces&rdquo; for the automation in <strong>Settings</strong> -> <strong>Automations</strong> to see a step-by-step log of what happened.</li><li><strong>The state is &lsquo;unknown&rsquo;.</strong> Your template sensor might be trying to read an attribute that doesn&rsquo;t exist. Double-check the entity ID and attribute name in your <code>configuration.yaml</code>.</li></ul><h2 id=where-to-go-from-here>Where to Go From Here</h2><p>Congratulations! You now have an automated air purifier that responds to the <strong>Home Assistant Air Quality Index</strong>. This project opens the door to so much more.</p><ul><li><strong>Add a Physical Button</strong>: Use another GPIO pin on the ESP32 to add a physical button that overrides the automation, letting you manually turn the purifier on or off.</li><li><strong>Create an Energy-Saving Mode</strong>: Modify the automation to only run during certain hours of the day.</li><li><strong>Build a Dashboard</strong>: Create a Lovelace dashboard card that shows the current AQI, the purifier&rsquo;s status, and a history graph. It&rsquo;s incredibly satisfying to watch it work.</li><li><strong>Control Multiple Purifiers</strong>: Use the same principle to control purifiers in different rooms based on individual room sensors.</li></ul><p>This project perfectly illustrates the power of Home Assistant: tying together commercial sensors, DIY hardware, and complex logic to create a truly smart home that works for you.</p><hr><h3 id=frequently-asked-questions-faq>Frequently Asked Questions (FAQ)</h3><p><strong>Q: Can I use an ESP8266 (like a Wemos D1 Mini) instead of an ESP32?</strong>
<strong>A:</strong> Absolutely! The process is identical. Just change the <code>esp32:</code> section in the ESPhome YAML to <code>esp8266:</code> and select an appropriate board like <code>d1_mini</code>.</p><p><strong>Q: My air purifier has a smart plug. Can I use that instead of a relay?</strong>
<strong>A:</strong> Yes, and it&rsquo;s often easier! If you have a Tuya, Kasa, or other smart plug that&rsquo;s already integrated into Home Assistant, you can skip the ESP32/relay hardware entirely. Just replace the <code>switch.air_purifier_relay</code> entity in the automation with your smart plug&rsquo;s entity.</p><p><strong>Q: What&rsquo;s a good AQI threshold to use?</strong>
<strong>A:</strong> This is personal, but a common guideline is: Good (0-50), Moderate (51-100), Unhealthy for Sensitive Groups (101-150). I find starting with an &ldquo;ON&rdquo; threshold of 50 and an &ldquo;OFF&rdquo; threshold of 35 provides a good balance of clean air and device longevity.</p><p><strong>Q: Is it safe to run an air purifier automatically for long periods?</strong>
<strong>A:</strong> Most modern air purifiers are designed for long runtimes. However, always consult your device&rsquo;s manual. The hysteresis in our automation helps prevent the excessive wear and tear that can come from frequent on/off cycling.</p><p><em>Looking for more DIY smart home projects? Check out my guide on <a href=https://omarghader.github.io/how-to-monitor-your-home-temperature-with-esp32-and-xiaomi-mijia-using-esphome/>monitoring home temperature with ESP32 and Xiaomi sensors</a> or my deep dive into <a href=https://omarghader.github.io/zigbee2mqtt-aqara-temperature-ccr2531-home-assistant/>setting up Zigbee2MQTT with Aqara sensors</a>.</em></p></div><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=auto data-full-width-responsive=true data-ad-client=ca-pub-2980078129213070 data-ad-slot></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></section><footer class=post-full-footer><section class=author-card><img class=author-profile-image src=https://omarghader.github.io/img/me/omar.jpg alt=Author><section class=author-card-content><h4 class=author-card-name><a href=https://omarghader.github.io/>Omar Ghader</a></h4><p>Monitoring, DevOps and SmartHome</p></section></section></footer></article></div></main><aside class="read-next outer"><div class=inner><div class=read-next-feed><article class=read-next-card style=background-image:url(https://omarghader.github.io/img/blog-cover.jpg)><header class=read-next-card-header><small class=read-next-card-header-sitetitle>&mdash; Omar Ghader &mdash;</small><h3 class=read-next-card-header-title><a href=https://omarghader.github.io/tags/home-assistant/>#home assistant</a></h3></header><div class=read-next-divider><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg></div><div class=read-next-card-content><ul><li><a href=https://omarghader.github.io/vmalert-setup/>Vmalert: Revamp your Prometheus alert with microservices</a></li><li><a href=https://omarghader.github.io/monitor-disk-space-node-exporter-prometheus-grafana/>Monitoring Disk Space Across Servers Using Node Exporter and Prometheus</a></li><li><a href=https://omarghader.github.io/homeassistant-air-quality-pms5003-esp32-2025/>HomeAssistant Air Quality Monitoring: Why PMS5003 with ESP32 is the Best Combo for 2025</a></li><li><a href=https://omarghader.github.io/monitoring-stack-prometheus-victoriametrics-grafana/>Building a Monitoring Stack with Prometheus, VictoriaMetrics, and Grafana: A Full Setup Guide</a></li></ul></div><footer class=read-next-card-footer><a href=https://omarghader.github.io/tags/home-assistant/>See all related posts →</a></footer></article><article class="post-card post"><a class=post-card-image-link href=https://omarghader.github.io/prometheus-labels-relabeling-clean-metrics-guide/><div class=post-card-image style=background-image:url(https://omarghader.github.io/defimg/3.jpg)></div></a><div class=post-card-content><a class=post-card-content-link href=https://omarghader.github.io/prometheus-labels-relabeling-clean-metrics-guide/><header class=post-card-header><span class=post-card-tags>#prometheus
#monitoring
#observability
#devops
#metrics
#labels
#relabeling</span><h2 class=post-card-title>Using Labels and Relabeling in Prometheus for Clean, Scalable Metrics</h2></header><section class=post-card-excerpt><p>Learn how to use Prometheus labels and relabeling rules to organize, filter, and manage your metrics for a cleaner, more scalable monitoring setup.</p></section></a><footer class=post-card-meta><img class=author-profile-image src=https://omarghader.github.io/img/me/omar.jpg alt=Author>
<span class=post-card-author><a href=https://omarghader.github.io/>Omar Ghader</a></span></footer></div></article></div></div></aside><div class=floating-header><div class=floating-header-logo><a href=https://omarghader.github.io/><img src=https://omarghader.github.io/img/logo.png alt>
<span></span></a></div><span class=floating-header-divider>&mdash;</span><div class=floating-header-title>Control and Automate Air Purifier with ESP32 and Home Assistant Air Quality Index</div><div class=floating-header-share><div class=floating-header-share-label>Share this<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 15.5V4a1.5 1.5.0 113 0v4.5h2a1 1 0 011 1h2a1 1 0 011 1H18a1.5 1.5.0 011.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2.0 011.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg></div><a class=floating-header-share-tw href="https://twitter.com/share?text=Control%20and%20Automate%20Air%20Purifier%20with%20ESP32%20and%20Home%20Assistant%20Air%20Quality%20Index&url=https%3a%2f%2fomarghader.github.io%2fautomate-air-purifier-esp32-home-assistant-aqi%2f" onclick="return window.open(this.href,'share-twitter','width=550,height=235'),!1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088.0 01-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015.0 01-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25.0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688.0 5.063-.875 7.188-2.5-1.25.0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5.0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673.0 01-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228.0 01-1.875-2c-.5-.875-.688-1.813-.688-2.75.0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579.0 011.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48.0 003.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a><a class=floating-header-share-fb href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fomarghader.github.io%2fautomate-air-purifier-esp32-home-assistant-aqi%2f" onclick="return window.open(this.href,'share-facebook','width=580,height=296'),!1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86.0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg></a></div><progress class=progress value=0><div class=progress-container><span class=progress-bar></span></div></progress></div><footer class="site-footer outer"><div class="site-footer-content inner"><section class=copyright style=line-height:1.3em><a href=https://omarghader.github.io/>omarghader</a><br></section><nav class=site-footer-nav><a href=https://omarghader.github.io/>Latest Posts</a>
<a href=https://github.com/omarghader target=_blank rel=noopener>Github</a></nav></div></footer></div><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script type=text/javascript src=//code.jquery.com/jquery-3.2.1.min.js></script><script type=text/javascript src=https://omarghader.github.io/js/jquery.fitvids.js></script><script>hljs.initHighlightingOnLoad()</script><script>window.addEventListener("load",function(){var a=document.createElement("script");a.src="https://www.googletagmanager.com/gtag/js?id=G-SMB08YT14H",a.async=!0,document.head.appendChild(a),a.onload=function(){window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date),a("config","G-SMB08YT14H")}})</script><script>$(document).ready(function(){var j=$(".post-full-content"),g,d,e,b,f,c,a;j.fitVids(),g=document.querySelector('progress'),d=document.querySelector('.floating-header'),e=document.querySelector('.post-full-title'),b=window.scrollY,f=window.innerHeight,c=$(document).height(),a=!1;function k(){b=window.scrollY,h()}function l(){f=window.innerHeight,c=$(document).height(),h()}function h(){a||requestAnimationFrame(i),a=!0}function i(){var h=e.getBoundingClientRect().top+window.scrollY,i=e.offsetHeight+35,j=c-f;b>=h+i?d.classList.add('floating-active'):d.classList.remove('floating-active'),g.setAttribute('max',j),g.setAttribute('value',b),a=!1}window.addEventListener('scroll',k,{passive:!0}),window.addEventListener('resize',l,!1),i()})</script></body></html>